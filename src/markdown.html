<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>STATS CATEGORY ORDER Extension Command</title>

<link rel="stylesheet" type="text/css" href="extsyntax.css" />





</head>

<body>
<!-- rmarkdown v1 -->

<h1>STATS CATEGORY ORDER Extension Command</h1>

<p>Create macros or MRSETS for variable categories or MD sets</p>
<div class="syntax">
<p>STATS CATEGORY ORDER<br/>
ITEMS = <em>itemlist</em><sup>&#42;</sup><br/>
PREFIX = <em>string</em><br/>
NAMES = <em>names</em><br/>
SPECIALVALUES = <em>special values</em><br/>
SPECIALVARS = <em>special variables</em><br/>
OTHER = YES or NO<sup>&#42;&#42;</sup><br/>
CUSTOMATTR = NO<sup>&#42;&#42;</sup> or YES</br>
ATTRNAME = <em>name</em></br>

or<br/>
/COUNTORDERING<br/>
VARIABLES = <em>list of variables</em><sup>&#42;</sup><br/>
COUNTVALUES = <em>list of values to count</em><sup>&#42;</sup><br/>
MACRONAME = <em>&ldquo;name for generated macro&rdquo;</em><sup>&#42;</sup><br/>
MINCOUNT = <em>minimum number of cases for inclusion (&lt;)</em><br/>
MINPERCENT = <em>minimum percentage of cases for inclusion (&lt;)</em><br/>
MAXCOUNT = <em>maximum number of cases for inclusion (&gt;=)</em><br/>
MAXPERCENT = <em>maximum percentage of cases for inclusion (&gt;=)</em><br/>
SEPARATOR = <em>&ldquo;separator between variables in macro definition&rdquo;</em>  </p>

<p>/OPTIONS 
ORDER = A or D<sup>&#42;&#42;</sup><br/>
SPECIALSLOC = AFTER<sup>&#42;&#42;</sup> or BEFORE<br/>
CATEGORYLABELS = VARLABELS<sup>&#42;&#42;</sup> or COUNTEDVALUES<br/>
MISSING = INCLUDE or EXCLUDE<sup>&#42;&#42;</sup></p>

<p>/HELP</p>

<p><sup>&#42;</sup> Required depending on mode of use<br/>
<sup>&#42;&#42;</sup> Default  </p>
</div>
<p>If not using COUNTORDERING, either PREFIX or NAMES or a custom attribute is required.
If using COUNTORDERING, VARIABLES, COUNTVALUES, and MACRONAME are required.</p>


<pre class="example"><code>STATS CATEGORY ORDER ITEMS = jobcat edyears $cars PREFIX=reorder.

STATS CATEGORY ORDER /COUNTORDERING VARIABLES=x y z
    COUNTVALUES = 1 2 MACRONAME=&quot;!onesandtwosorder&quot; SEPARATOR=&quot;+&quot;.
</code></pre>

<p>This procedure creates macro definitions or multiple dichotomy sets for use
in Custom Tables in order to control the category order beyond what is built
in to that procedure.  It can also create macros listing variables in order
of the frequency of occurrence of specified values.  For variables, it can
also create a custom attribute.</p>

<p>The procedure processes three types of input.  For an ordinary variable
it creates a macro definition that lists the categories in sorted order of
the counts with the ability to move selected values to the top or bottom
of the list.  A typical usage would be to move an &ldquo;other&rdquo; category to the
bottom.  The generated macro can be used in the CTABLES CATEGORIES
subcommand to specify the order.  In addition or instead of a macro definition,
it can create a custom attribute.</p>

<p>The second type of input is one or more multiple dichotomy sets.  An
MD set consists of a group of variables representing choices or attributes
as yes (the counted value) or no for each attribute.  The procedure
creates a new MD set consisting of the same variable plus optionally
other similar variables with the variables listed in sorted count
order.  By specifying special variables, typically but not
necessarily included in the set definition, those variables can be moved
to the top or bottom of the list.  Tabulating the new sets with custom tables
will list the variables in the order generated by this procedure.</p>

<p>The third type of input is a list of variables and a specification of what
values to count.  It produces a macro definition listing the variables
in order of frequency of the countvalues, subject to an optional
minimum threshold.  For this type of operation, the COUNTVALUES subcommand
is used and the keywords on the first section above do not apply.  On
OPTIONS only the missing value setting applies.</p>

<h3>The First Two Input Types</h3>

<p>None of these keywords apply if COUNTORDERING is used.  </p>

<p><strong>ITEMLIST</strong> specifies the variables and MD sets to process.  All variables either
listed or contained in the sets must have the same fundamental type.</p>

<p><strong>PREFIX</strong> or <strong>NAMES</strong> specify the output names.  PREFIX specifies text that will
be prepended to the input names to form the output.  NAMES specifies
a list of explicit names for the output.  Either PREFIX or NAMES is
required unless a custom attribute is created, but only one can be used.</p>

<p><strong>SPECIALVALUES</strong> lists the values that are special for ordinary variables.<br/>
String values should be enclosed in quotes if they contain a blank.<br/>
Special values or variables will be moved out of the sort order.</p>

<p><strong>SPECIALVARS</strong> lists the variables that contain special values, 
e.g., an &ldquo;other&rdquo; variable for MD sets.  These variables will be 
moved out of the sort order.  They do not have to be members of
the input sets.</p>

<p><strong>OTHER</strong> specifies whether to add labeled values not found in
the data to the result with a count of zero.  This only applies
to ordinary variables.  If missing values are excluded,
labeled missing values are omitted.</p>

<p><strong>CUSTOMATTR</strong> = YES causes a custom attribute to be created.
The name of the attribute defaults to ORDER but can be set with
<strong>ATTRNAME</strong>.  If CUSTOMATTR = NO, ATTRNAME is ignored.</p>

<p>Here is an example using the custom attribute with Python</p>

<pre class="example"><code>
STATS CATEGORY ORDER items=jobcat customattr=yes.
begin program.
import spss, spssaux

order = spssaux.VariableDict()['jobcat'].Attributes["ORDER"]
cmd="""ctables /table jobcat
/categories variables=jobcat [%s]""" % order
spss.Submit(cmd)
end program.
</code></pre>

<h2>OPTIONS </h2>

<p>Only MISSING and ORDER apply for the third type of input.  </p>

<p><strong>ORDER</strong> specifies how the values or variables are sorted: in ascending
or descending order of the count.</p>

<p><strong>SPECIALSLOC</strong> specifies whether the special values appear above or below
the other values.</p>

<p><strong>CATEGORYLABELS</strong> specifies how set values are labelled.  See the
MRSETS command documentation for details.</p>

<p><strong>MISSING</strong> specifies whether or not user missing values are included
based on the data or labels.  If a missing value is listed in
special values, however, it is always included.
By default missing values are excluded.</p>

<h2>COUNTORDERING</h2>

<p><strong>VARIABLES</strong> specifies the list of input variables.  All the
variables must be of the same type (all numeric or all string), but
string length may vary.</p>

<p><strong>COUNTVALUES</strong> specifies one or more values to count.  String
values should be quoted.  For each variable a (weighted) count of the
number of cases having any of these values is computed.</p>

<p><strong>MACRONAME</strong> specifies a name to be assigned to the generated macro.
If the name does not start with &ldquo;!&rdquo;, a ! is prepended.  The name
should be quoted.  The generated macro lists the input variables
in descending or ascending order of the number of cases having
any of the counted values.</p>

<p><strong>MINCOUNT</strong> and <strong>MINPERCENT</strong> specify the minimum number of cases
or the minimum percentage of cases that a variable must have
in order to be included in the macro definition.  Both default
to zero, meaning that all variables are included. Weights are
used if weighting is on.  If MISSING=EXCLUDE, the calculations
are based on the non-missing cases.</p>

<p><strong>MAXCOUNT</strong> and <strong>MAXPERCENT</strong> specify the maximum number of cases
or the maximum percentage of cases that a variable must not exceed
in order to be included in the macro definition.  The test
is greater than or equal, so, for example, MAXPERCENT=100 would exclude variables
where all cases have any of the counted values.</p>

<p><strong>SEPARATOR</strong> specifies what character(s) should separate the
variable names in the generated macro definition.   The value
should be quoted.  The default is
a sngle blank, but in order to use the macro in a CTABLES table expression,
specify &ldquo;+&rdquo;</p>

<p>/HELP displays this text and does nothing else.</p>
<p>&copy; Copyright IBM Corp. 1989, 2016</p>
</body>

</html>

