<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Создать макрокоманды или наборы множественных дихотомий для управления порядком категорий</title>

  <style type="text/css">
  <!-- 

  H1 {font-weight:bold; color:#006699; font-size:125%; }
  H2 {font-weight:bold; color:#006699; font-size:110%; }
  TABLE {font-size:100%;}

  /* paragraph tags */
  .step {text-indent: -1.3em; margin-left:1.3em; margin-top: 0px;}
  .menuselection {margin-left:10px}
  .bullet {list-style-type: disc;margin-top:12px; margin-left:36px; text-indent:-1em; }
  .codeblock {background-color: #ffffe6; display:block; margin-left:5px; padding:5px;}

  /* inline tags */
  .screen {font-weight:bold; color:#408080}                       /*** used refer to on-screen text ***/
  .name {font-style: italic}                                                       /*** used to tag names, such as variable names, file names, and so forth ***/
  .runinhead {font-weight: bold} 
  .superscript {vertical-align:super; font-size:80%}
  .subscript {vertical-align:sub; font-size:80%}

  --> 
    </style>
</head>

<body>
<h1>Создать макрокоманды или наборы множественных дихотомий для управления порядком категорий</h1>
Эта процедура создает определения макрокоманд или наборов множественных дихотомий для использования в Пользовательских таблицах, чтобы управлять порядком категорий сверх встроенного в процедуру.  Для обычных переменных (не для наборов множественных дихотомий) может также создавать пользовательские атрибуты, содержащие порядок, который можно использовать с возможностями программирования Python.
<p>Процедура обрабатывает два типа входных данных. Для простых переменных она создает определение макрокоманды, перечисляющей категории в порядке количеств, с возможностью переместить выбранные значения в начало или в конец списка. Обычное использование состоит в перемещении вниз категории "other".  Сгенерированную макрокоманду можно использовать в подкоманде CTABLES CATEGORIES, чтобы задать порядок.  При использовании пользовательского атрибута синтаксис подкоманды можно сгенерировать при помощи кода Python.</p>
<p>Второй тип входных данных - это один или несколько наборов множественных дихотомий.  Набор множественных дихотомий состоит из группы переменных, представляющих возможности выбора или атрибуты как yes (счетное значение) или no для каждого атрибута.  Процедура создает новый набор множественных дихотомий, состоящий из той же переменной и необязательных других сходных переменных, которые перечислены в порядке счета.  Указав специальные переменные, которые обычно, хотя и не обязательно, включены в определение набора, эти переменные можно переместить в начало или в конец списка.  При включении новых наборов в пользовательские таблицы эти переменные будут перечисляться в том порядке, который сгенерирован процедурой.</p>
<p>
<p class="bullet">И регулярные переменные, и наборы множественных дихотомий можно обрабатывать одновременно в соответствии со спецификациями их типов.</p>
<p class="bullet">Эта процедура главным образом полезна для CTABLES, но она может использоваться и для наборов множественных дихотомий в GGRAPH.</p>
<p class="bullet">Эту процедуру нельзя использовать с наборами нескольких категорий, но команда расширения STATS MCSET CONVERT может преобразовать набор нескольких категорий в набор множественных дихотомий.</p>

<p><span class="runinhead">Переменные и наборы множественных дихотомий</span>
Выберите переменные и наборы множественных дихотомий для обработки.  Для каждой выбранной переменной будет создана макрокоманда; для каждого выбранного набора будет создан набор множественных дихотомий.</p>
<p class="bullet">У всех выбранных переменных должен быть одинаковы главный тип (числовой или строковый), заданный непосредственно или через участие в группе.</p>
</p>
<p><span class="runinhead">Специальные значения</span>
Введите значения, представляющие собой специальные значения для обыкновенных переменных.  Разделите эти значения пробелами.  Если в строках есть пробелы, эти строки надо заключить в кавычки.  Специальные значения или переменные будут перемещены из существующего порядка сортировки в соответствии со спецификациями в разделе Опции.</p>
<p class="bullet">Эти значения не влияют на наборы множественных дихотомий.
</p>


<p><span class="runinhead">Специальные переменные</span> Выберите переменные, содержащие специальные значения, например, переменную "other" для наборов множественных дихотомий.  При определении новых наборов эти переменные будут перемещены из упорядоченной сортировки в соответствии со спецификациями из раздела Опции.</p>
<p class="bullet">Эти значения не влияют на обыкновенные переменные.
</p>
<p><span class="runinhead">Значения, не найденные среди данных, и переменные пустых наборов</span>
Для обычных переменных включите этот переключатель, чтобы добавить помеченные значения, не найденные среди данных, в результаты с нулевым количеством.  
Если отсутствующие значения исключаются, помеченные отсутствующие значения пропускаются.</p>
<p>Для наборов это приводит к тому, что переменные компонентов наборов с нулевым количеством будут группироваться с другими переменными наборов.  Различия возникнут только при наличии специальных определенных переменных.</p>
<p><span class="runinhead">Имена макрокоманд или наборов множественных дихотомий</span> Этот переключатель определяет имена создаваемых элементов.  Если ввести префикс, у выходных имен будет следующий вид:<br>
префикс_входноеИмя<br>
Другой вариант - ввести список имен для выходных элементов.
Введите столько имен, сколько создано переменных и наборов.
Для определения макрокоманды в начале имени будет добавлен знак "!".
Для набора множественных дихотомий в начало имени добавляется "$".</p>
<p class="bullet">Существующие переменные или наборы с тем же именем, что у выходного элемента, будет заменены, кроме случаев, когда возникает ошибка из-за несогласованности типа существующей переменной с типом нового элемента вывода.</p>
<p>Если выбрано Нет, укажите пользовательский атрибут в поле Пользовательский атрибут.
</p>

<p><span class="runinhead">Пользовательский атрибут для порядка категорий</span>
Включите этот переключатель, чтобы создать пользовательский атрибут для каждой переменной, задающий порядок.
Его можно использовать в коде Python для создания соответствующего синтаксиса CTABLES.
Пользовательские атрибуты можно выводить в представлении Переменные редактора данных и в других местах.
Они сохраняются вместе с набором данных, устраняя необходимость повторного вычисления в будущем сеансе, если данные не изменились.
</p>
<p><span class="runinhead">Имя</span> В этом поле можно указать имя пользовательского атрибута.</p>
<p>Пример использования пользовательского атрибута в Python</p>

<p><span class="code">
STATS CATEGORY ORDER items=jobcat customattr=yes.</br>
begin program.</br>
import spss, spssaux</br>
</br>
order = spssaux.VariableDict()['jobcat'].Attributes["ORDER"]</br>
cmd="""ctables /table jobcat</br>
/categories variables=jobcat [%s]""" % order</br>
spss.Submit(cmd)</br>
end program.</br>
</span>
<h2>Параметры</h2>

<p><span class="runinhead">Порядок</span> Выберите порядок по возрастанию или по убыванию.  Категории или переменные наборов будут перечисляться по их количеству в выбранном направлении упорядочивания, кроме специальных переменных.</p>

<p><span class="runinhead">Положение специальных значений</span> Все специальные значения или переменные перемещаются в начало или в конец списка в соответствии с этой спецификацией.
</p>
<p><span class="runinhead">Не заданные пользователем значения</span> Выберите опцию, подсчитываются или игнорируются не заданные пользователем значения среди данных или меток.  
Этот параметр применяется к каждой переменной индивидуально.  Если специальное значение также отсутствует, оно будет учитываться независимо от данного параметра.  Системные значения отсутствия всегда игнорируются. </p>

<p><span class="runinhead">Метки категорий</span> Только для наборов множественных дихотомий.
Выберите, что используется для метки учитываемых значений, метки переменных в наборе переменных или метки учтенных значений.  Обычно эта опция та же, что в спецификации, используемой при создании входного набора.</p>

<h2>Дополнительные возможности</h2>
<p>
Это диалоговое окно генерирует синтаксис для команды расширения STATS CATEGORY ORDER. Чтобы показать справку синтаксиса, выполните следующий синтаксис:
</p>
<p class="codeblock">STATS CATEGORY ORDER /HELP.</p>
<p>Используя синтаксис, можно создать макрокоманду, которая выводит набор переменных в порядке частоты набора заданных значений.
</p>

<h2>Технические требования</h2>
Для этой команды требуется Python Essentials.
Этот пакет можно скачать с веб-сайта сообщества SPSS по адресу www.ibm.com/developerworks/spssdevcentral или взять его с установочного носителя.</p>

<p style="font-size:80%;">Copyright SPSS Inc. 1989,2021</p>
